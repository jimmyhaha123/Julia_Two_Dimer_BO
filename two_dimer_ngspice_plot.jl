include("two_dimer.jl")
using PyPlot
PyPlot.matplotlib.use("TkAgg")

#p = [10, 500.8503311528617, 10.1334079118446, 500.257939996455, 1252.5596186687374, 907.6616684318678, 1307.9963447178025, 1108.9921979803999, 0.2477040282026825, 0.495833133390885, 0.12519318530321832, 0.17070609736856535, 0.3390549484811537]
#p = [3518.7611128907256, 6274.369531607059, 64.42873835058236, 34.70580438538991, 961.7731371229286, 1001.3489690044886, 922.2383531936547, 905.8732527046743, 0.23642654586909886, 0.49921318295769235, 0.2760003570868289, 0.4881623534084347, 0.4068860654087108]
#p = [7280.7478058986335, 6071.13673640626, 29.311722619750782, 1859.2844046834432, 1035.1773545495157, 1075.2736648216833, 915.8522027133332, 1021.0816958356199, 0.3619122339731189, 0.3434627192277497, 0.17625736216748533, 0.3799961008849053, 0.252163049826263]
p = [387.55228304839915, 6470.88431377693, 3311.2648393315626, 8542.956315615698, 945.4576721195222, 924.4521614589363, 1094.8796247042544, 947.5780042727104, 0.1755646527686398, 0.17255270296717196, 0.2314583289629773, 0.2679159610601978, 0.14258163793733597]
#p = [240.21139646536434, 4867.878914881704, 8384.997250983319, 3108.0357327590455, 962.7116953317021, 1019.2521932376139, 1043.057313471482, 1003.4438974287144, 0.11616358235169735, 0.11402636375999353, 0.4568645360330499, 0.18172062172218917, 0.1946088045238457]
#p = [5120.983470364426, 6201.309487149043, 8787.620961049484, 7920.283087982607, 1240.4924403888529, 717.6627112205157, 1265.3452487478623, 740.8431321736181, 0.187671997995149, 0.43992078594056816, 0.3452718692296771, 0.4701205306867442, 0.08480412621348522]


loss, mag_transform, freqs, tseries, t_interp, min_idx = ngspice_objective(p, true, (0, 0.5e5))

println(min_idx)
println(loss)

plot(t_interp, tseries)
show()

plot(freqs, mag_transform)
show()



