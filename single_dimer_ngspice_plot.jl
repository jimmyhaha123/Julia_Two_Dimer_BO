include("single_dimer.jl")
using PyPlot
PyPlot.matplotlib.use("TkAgg")

p = [91.56838977355442, 9114.171523730261, 806.3990120136237, 1445.8980363167962, 0.33954143929635194, 0.15175839198898056]
p = [130.25037277742967, 7744.3171805543225, 779.1903193441603, 1328.96566839553, 0.07979457396955941, 0.2760862404709119]
p = [73.66503907381308, 6980.047551864795, 543.8022037767349, 1156.0876792090266, 0.4027742682261706, 0.27689905702227396]
# p = [496.77005662369663, 4784.079290204757, 744.4190591005824, 1498.4078331467463, 0.1182789418139555, 0.3351531694919475]
p = [754.342294, 5, 543.8022037767349, 1156.0876792090266, 0.4027742682261706, 0.27689905702227396]
insert!(p, 3, 200)
insert!(p, 5, 200)
insert!(p, 9, 550)


min_loss, mag_transform, freqs, tseries, t_interp, _ = ngspice_objective(p, true, (0, 1e6))
println(min_loss)
plot(t_interp, tseries)
show()

plot(freqs, mag_transform)
show()
